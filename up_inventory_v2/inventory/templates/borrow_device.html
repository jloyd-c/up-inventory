{% extends 'base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/borrow_device.css' %}"> <!-- reuse staff.css -->

<div class="staff-container">  <!-- same container -->

<!-- Borrow / Return Buttons -->
<div class="action-buttons">
  <a href="{% url 'inventory' %}" class="action-btn {% if request.resolver_match.url_name == 'inventory' %}active-btn{% endif %}">Borrow</a>
  <a href="{% url 'dashboard' %}" class="action-btn {% if request.resolver_match.url_name == 'dashboard' %}active-btn{% endif %}">Return</a>
</div>



  <!-- Inventory Form -->   
  <div class="card form-card">
    <div class="card-header">ADD NEW INVENTORY (BORROW RECORD)</div>
    <form action="#" method="post" class="staff-form">
      {% csrf_token %}
      <p>
        <label for="{{ form.name.id_for_label }}">Device Name:</label>
        {{ form.name }}
      </p>
      <p>
        <label for="{{ form.serial_number.id_for_label }}">Serial Number:</label>
        {{ form.serial_number }}
      </p>
      <p>
        <label for="{{ form.category.id_for_label }}">Category:</label>
        {{ form.category }}
      </p>
      <p>
        <label for="{{ form.status.id_for_label }}">Status:</label>
        {{ form.status }}
      </p>
      <button type="submit" class="btn submit-btn">Add Device</button>
    </form>
  </div>

  <!-- Inventory Table -->
  <div class="card table-card">
    <div class="card-header">INVENTORY RECORDS (BORROW RECORD)</div>

    <div class="search-download-wrapper">
      <form method="get" class="search-form">
        <input type="text" name="q" placeholder="Search inventory..." value="{{ query }}" class="search-input">
      </form>
      <a href="#" class="btn btn-download">Download Excel</a>
    </div>

    <table class="staff-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Serial #</th>
          <th>Category</th>
          <th>Status</th>
          {% if user.is_superuser %}
          <th>Actions</th>
          {% endif %}
        </tr>
      </thead>
      <tbody>
        {% for item in inventory_records %}
        <tr>
          <td>{{ item.name }}</td>
          <td>{{ item.serial_number }}</td>
          <td>{{ item.category }}</td>
          <td>{{ item.status }}</td>
          {% if user.is_superuser %}
          <td class="action-style">
            <!-- Edit Button -->
            <a href="javascript:void(0);" class="btn edit-btn"
              data-id="{{ item.id }}"
              data-name="{{ item.name|escapejs }}"
              data-serial="{{ item.serial_number|escapejs }}"
              data-category="{{ item.category }}"
              data-status="{{ item.status }}"
              onclick="handleEditClick(this)">
              Edit
            </a>

            <!-- Delete Button -->
            <form action="#" method="post" style="display:inline;">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger delete-btn" onclick="return confirm('Delete this item?')">Delete</button>
            </form>
          </td>
          {% endif %}
        </tr>
        {% empty %}
        <tr><td colspan="5">No inventory found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Edit Modal (Optional) -->
<!-- You can reuse the modal structure from staff if needed -->

{% endblock %}
